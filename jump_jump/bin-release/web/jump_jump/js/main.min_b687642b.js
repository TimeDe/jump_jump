function getPointFromTriangle(t){var e=Math.random(),i=Math.random(),n=(1-Math.sqrt(e))*t[0].x+Math.sqrt(e)*(1-i)*t[1].x+Math.sqrt(e)*i*t[2].x,r=(1-Math.sqrt(e))*t[0].y+Math.sqrt(e)*(1-i)*t[1].y+Math.sqrt(e)*i*t[2].y;return{x:n,y:r}}function getPointFromVertexs(t){var e=t.concat(),i=Math.floor(Math.random()*e.length),n=e[i];e.splice(i,1);var r=Math.floor(Math.random()*e.length),o=e[r];e.splice(r,1);var s=Math.floor(Math.random()*e.length),a=e[s];return getPointFromTriangle([n,o,a])}function isPointInVertexs(t,e){var i=drawShape(t,16777215,1);return i.hitTestPoint(e.x,e.y,!0)}function getRandomFromArray(t){var e=Math.floor(t.length*Math.random()),i=t[e];return t.splice(e,1),i}function randomInt(t,e){var i=e-t;return Math.floor(i*Math.random())+t}function getRandomFromArrayNoSplice(t){var e=Math.floor(t.length*Math.random()),i=t[e];return i}function copyArray(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}function getDistance(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function greyFlilter(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]}function filterFun(t,e,i,n,r,o,s,a,h){void 0===e&&(e=3394815),void 0===i&&(i=.8),void 0===n&&(n=35),void 0===r&&(r=35),void 0===o&&(o=2),void 0===s&&(s=3),void 0===a&&(a=!1),void 0===h&&(h=!1);var l=new egret.GlowFilter(e,i,n,r,o,s,a,h);t.filters=[l]}function clearFlilter(t){t.filters=[]}function drawLine(t,e,i,n){var r=new egret.Shape;return r.graphics.lineStyle(i,n),r.graphics.moveTo(t.x,t.y),r.graphics.lineTo(e.x,e.y),r.graphics.endFill(),r}function drawShape(t,e,i){var n=new egret.Shape;n.graphics.lineStyle(i,e),n.graphics.beginFill(e),n.graphics.moveTo(t[0].x,t[0].y);for(var r=1;r<t.length;r++)n.graphics.lineTo(t[r].x,t[r].y);return n.graphics.lineTo(t[0].x,t[0].y),n.graphics.endFill(),n}function flash(t){egret.Tween.get(t).to({alpha:0},300).to({alpha:1},300).to({alpha:0},200).to({alpha:1},200)}function shake(t){var e=t.y,i=t.x,n=5;egret.Tween.get(t).to({x:i+n,y:e},50).to({x:i,y:e},50).to({x:i-n,y:e},50).to({x:i,y:e},50)}function buttonTapAction(t,e,i){var n,r,o=0,s=0,a=0,h=0,l=1.1,c=.9;a=t.scaleX,h=t.scaleY,setTimeout(function(){n=t.x,r=t.y},100);var u=function(){o=(t.width*a-t.width*a*c)*(.5-t.anchorOffsetX/t.width),s=(t.height*h-t.height*h*c)*(.5-t.anchorOffsetY/t.height),t.x+=o,t.y+=s,t.scaleX=a*c,t.scaleY=h*c},p=function(){t.x=n,t.y=r,t.scaleX=a,t.scaleY=h},d=function(){o=(t.width*a-t.width*a*l)*(.5-t.anchorOffsetX/t.width),s=(t.height*h-t.height*h*l)*(.5-t.anchorOffsetY/t.height),t.x+=o,t.y+=s,t.scaleX=a*l,t.scaleY=h*l},f=function(){t.x=n,t.y=r,t.scaleX=a,t.scaleY=h};t.addEventListener(mouse.MouseEvent.MOUSE_OVER,d,this),t.addEventListener(mouse.MouseEvent.MOUSE_OUT,f,this),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,u,i),t.addEventListener(egret.TouchEvent.TOUCH_END,p,i),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,p,i),t.addEventListener(egret.TouchEvent.TOUCH_TAP,e,i)}function breathAction(t,e,i){void 0===e&&(e=1),void 0===i&&(i=1.2),egret.Tween.removeTweens(t),t.scaleX=e,t.scaleY=e,egret.Tween.get(t,{loop:!0}).to({scaleX:i,scaleY:i},800).to({scaleX:e,scaleY:e},800)}function filterAction(t,e,i){var n=2937968;e||(n=15149616);var r=200;filterFun(t,n,.8),egret.Tween.get(t).wait(r).call(function(){clearFlilter(t)}).wait(r).call(function(){filterFun(t,n,.8)}).wait(r).call(function(){clearFlilter(t)}).call(function(){i&&i()})}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function s(t){try{h(n.next(t))}catch(e){o(e)}}function a(t){try{h(n["throw"](t))}catch(e){o(e)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,o=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},EventHandler=function(){function t(){this._hander_maps={}}return t.prototype.on=function(t,e,i){var n=this._hander_maps[t]||[];n.push({cb:e,target:i}),this._hander_maps[t]=n},t.prototype.fire=function(t,e){var i=this._hander_maps[t]||[];0==i.length&&console.log("消息发送失败，无效的event事件：  ",t);for(var n=0;n<i.length;n++){var r=i[n];r.cb.call(r.target,e)}},t.prototype.removeListener=function(t,e,i){var n=this._hander_maps[t]||[];0==n.length&&console.log("事件移除失败，无效的event事件：  ",t);for(var r=[],o=0;o<n.length;o++){var s=n[o];(s.cb!==e||s.target!==i)&&r.push(s)}this._hander_maps[t]=r},t.prototype.removeAll=function(){this._hander_maps={}},t}();__reflect(EventHandler.prototype,"EventHandler");var GameIndex=function(t){function e(){var e=t.call(this)||this;return e.returnGame=function(){soundController.playEffect("sound_back_mp3",0,1),e.playTitle(),e.indexGroup.visible=!0,e.play.overGame(!1),e.removeChild(e.play),soundController.stopBG("gameBgm_mp3"),e.playScaleAction(!0)},e.skinName=skins.GameIndexSkin,e}return __extends(e,t),e.prototype.createChildren=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.createChildren.call(this),mouse.enable(this.stage),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayBtnClick,this),this.playScaleAction(!0),[2]})})},e.prototype.onPlayBtnClick=function(){this.startGame()},e.prototype.playScaleAction=function(t){if(egret.Tween.removeTweens(this.startBtn),this.startBtn.scaleX=1,this.startBtn.scaleY=1,t){var e=1.1,i=.9;egret.Tween.get(this.startBtn,{loop:!0}).to({scaleX:e,scaleY:e},1e3).to({scaleX:i,scaleY:i},500).to({scaleX:1,scaleY:1},500)}},e.prototype.startGame=function(){this.indexGroup.visible=!1,this.play||(this.play=new GamePlay(this)),soundController.playEffect("sound_start_mp3",0,1),this.play.startGame(),this.addChild(this.play)},e.prototype.playTitle=function(){},e.prototype.fredTap=function(){},e}(eui.Component);__reflect(GameIndex.prototype,"GameIndex");var GamePlay=function(t){function e(e){var i=t.call(this)||this;return i.game_start=!1,i.ui_loaded=!1,i.resultAniNumber=1,i.leftOrigin={x:138,y:794},i.rightOrigin={x:499,y:794},i.blockStrArr=["block1_png","block2_png","block3_png"],i.blockArr=[],i.direction=1,i.minDistance=220,i.maxDistance=320,i.tanAngle=.5,i.startT=0,i.speed=300,i.distancX=0,i.score=0,i.skinName=skins.GamePlaySkin,i.gameIndex=e,i}return __extends(e,t),e.prototype.refresh=function(){this.startGame()},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.ui_loaded=!0,this.init()},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return mouse.enable(this.stage),this.startGame(),[2]})})},e.prototype.returnGame=function(){egret.Tween.removeAllTweens(),this.gameIndex&&this.gameIndex.returnGame()},e.prototype.initDBAction=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},e.prototype.startGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.game_start?[2]:(this.clear(),soundController.playBG("gameBgm_mp3"),soundController.setBGVolumeByUrl("gameBgm_mp3",.4),this.game_start=!0,this.lockWorld(!1),this.addEvent(),this.initBlock(),[2])})})},e.prototype.overGame=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.game_start=!1,soundController.stopBG("gameBgm_mp3"),soundController.stopEffect("tip_sound_mp3"),egret.Tween.removeAllTweens(),this.lockWorld(!0),t&&(this.result||(this.result=new GameResult(this)),this.addChild(this.result),this.result.showPage(!0,5)),[2]})})},e.prototype.lockWorld=function(t){this.gameGroup.touchEnabled=!t,this.gameGroup.touchChildren=!t},e.prototype.clear=function(){if(this.ui_loaded){this.result&&this.result.parent&&(this.result.parent.removeChild(this.result),this.result=null);for(var t=0;t<this.blockArr.length;t++)this.gameGroup.removeChild(this.blockArr[t]);this.blockArr=[],this.direction=1,this.score=0}},e.prototype.addEvent=function(){this.gameGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),this.gameGroup.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this)},e.prototype.initBlock=function(){this.standBlock=this.getBlockItem(),this.standBlock.x=this.leftOrigin.x,this.standBlock.y=this.leftOrigin.y,this.img_player.x=this.standBlock.x,this.img_player.y=this.standBlock.y,this.gameGroup.addChild(this.standBlock),this.direction=1,this.setNextBlock(),this.setScoreNum()},e.prototype.getBlockItem=function(){var t=new eui.Image,e=Math.floor(3*Math.random());return t.source=this.blockStrArr[e],t.anchorOffsetX=222,t.anchorOffsetY=78,this.blockArr.push(t),t},e.prototype.setNextBlock=function(){var t=this.getBlockItem(),e=new egret.Point(this.standBlock.x,this.standBlock.y),i=Math.floor(Math.random()*(this.maxDistance-this.minDistance)+this.minDistance);t.x=e.x+i*this.direction,t.y=e.y-i*this.tanAngle,this.standBlock=t,this.gameGroup.addChild(t)},e.prototype.touchBegin=function(){this.startT=timeController.getSystemTime(),egret.Tween.get(this.img_player).to({scaleY:.8},500)},e.prototype.touchEnd=function(){var t=this;this.img_player.scaleY=1;var e=timeController.getSystemTime(),i=(e-this.startT)/1e3;this.distancX=this.speed*i,this.lockWorld(!0),this.tagPose=new egret.Point,this.tagPose.x=this.img_player.x+this.distancX*this.direction,this.tagPose.y=this.img_player.y+this.distancX*this.direction*(this.img_player.y-this.standBlock.y)/(this.img_player.x-this.standBlock.x),egret.Tween.removeAllTweens(),egret.Tween.get(this).to({factor:1},500).call(function(){t.checkResult()}),this.img_player.anchorOffsetX=this.img_player.width>>1,this.img_player.anchorOffsetY=this.img_player.height>>1,egret.Tween.get(this.img_player).to({rotation:360*this.direction},200).call(function(){t.img_player.anchorOffsetX=t.img_player.width>>1,t.img_player.anchorOffsetY=t.img_player.height-20})},e.prototype.checkResult=function(){var t=this,e=(this.maxDistance-this.minDistance-15)*(this.maxDistance-this.minDistance-15),i=(this.standBlock.x-this.img_player.x)*(this.standBlock.x-this.img_player.x)+(this.standBlock.y-this.img_player.y)*(this.standBlock.y-this.img_player.y);if(e>=i){++this.score,this.setScoreNum(),this.direction=Math.random()>.5?1:-1;var n=new egret.Point(this.direction<0?this.rightOrigin.x:this.leftOrigin.x,this.direction>0?this.rightOrigin.y:this.leftOrigin.y),r=n.x-this.standBlock.x,o=n.y-this.standBlock.y;this.resetBlock(r,o),egret.Tween.get(this.img_player).to({x:this.img_player.x+r,y:this.img_player.y+o},1e3).call(function(){t.lockWorld(!1),t.setNextBlock()})}else this.overGame()},e.prototype.resetBlock=function(t,e){for(var i=this.blockArr.length-1;i>=0;i--){var n=this.blockArr[i].x+t,r=this.blockArr[i].y+e;this.blockArr[i].x<=-100||this.blockArr[i].y>=this.gameGroup.height+100||this.blockArr[i].x>=this.gameGroup.width+100?(this.gameGroup.removeChild(this.blockArr[i]),this.blockArr.splice(i,1)):egret.Tween.get(this.blockArr[i]).to({x:n,y:r},1e3)}},e.prototype.setScoreNum=function(){this.score_lab.text="得分: "+this.score.toString()},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){this.img_player.x=(1-t)*(1-t)*this.img_player.x+2*t*(1-t)*(this.img_player.x+this.tagPose.x)/2+t*t*this.tagPose.x,this.img_player.y=(1-t)*(1-t)*this.img_player.y+2*t*(1-t)*(this.tagPose.y-300)+t*t*this.tagPose.y},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(GamePlay.prototype,"GamePlay");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.TextField.default_fontFamily="FZCuYuan-M03S",egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),t=new eui.UILayer,e=new eui.UILayer,timeController.startTicker(),this.addChild(t),this.addChild(e),t.addChild(new GameIndex),(new XDFLogoComponent).addToParent(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),[4,RES.loadConfig("default.res.json",window.__math2_res_config__||"resource/")];case 1:return i.sent(),[4,RES.loadGroup("loading")];case 2:return i.sent(),t=new LoadingUI,this.stage.addChild(t),[4,this.loadMusic()];case 3:return i.sent(),[4,this.loadTheme()];case 4:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 5:return i.sent(),this.stage.removeChild(t),window.platform.sendMessage(CMD.CODE.INIT,"游戏初始化完成",CMD.AnswerCode.Invalid),[3,7];case 6:return e=i.sent(),console.error(e),[3,7];case 7:return[2]}})})},e.prototype.loadMusic=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:t=RES.getGroupByName("music"),e=0,i.label=1;case 1:return e<t.length?[4,RES.getResAsync(t[e].name)]:[3,4];case 2:i.sent(),i.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e}(eui.UILayer);__reflect(Main.prototype,"Main");var PathController=function(){function t(){this.pathsPoint={}}return t.prototype.clear=function(){this.pathsPoint={}},t.prototype.pushPoint2=function(t,e){if(t==e)return console.error("PathController 传入pos1==pos2,请检查逻辑"),!1;var i=this.getEquationByPoss(t,e),n=this.addGapCoordinate(t,e);n.length>0&&(void 0==this.pathsPoint[i]?(this.pathsPoint[i]=[],this.pathsPoint[i].push(n)):this.checkPrevPoint(n,i))},t.prototype.getPathPoint=function(t){void 0===t&&(t=[]);var e=[];for(var i in this.pathsPoint)if(-1==t.indexOf(i))for(var n=0,r=this.pathsPoint[i];n<r.length;n++){var o=r[n];e.push(o)}return e},t.prototype.checkPrevPoint=function(t,e){for(var i=t[0],n=t[t.length-1],r=0;r<this.pathsPoint[e].length;r++){var o=this.pathsPoint[e][r];if(this.equalPoints(o[0],n))return t.pop(),o=t.concat(o),this.pathsPoint[e].splice(r,1),void this.checkPrevPoint(o,e);if(this.equalPoints(o[o.length-1],i))return o.pop(),o=o.concat(t),this.pathsPoint[e].splice(r,1),void this.checkPrevPoint(o,e)}-1==this.pathsPoint[e].indexOf(t)&&this.pathsPoint[e].push(t)},t.prototype.sliceCutCoordinate=function(t,e){var i=this.pathsPoint[t];if(void 0==i)return e;for(var n=[],r=0,o=i;r<o.length;r++)for(var s=o[r],a=0,h=e;a<h.length;a++){var l=h[a],c=this.indexOfPointInPoints(l,s);c>0&&c!==s.length-1&&n.push(l)}for(var u=0,p=n;u<p.length;u++){var l=p[u],c=this.indexOfPointInPoints(l,e);e.splice(c,1)}return e},t.prototype.indexOfPointInPoints=function(t,e){for(var i=-1,n=0,r=e;n<r.length;n++){var o=r[n];this.equalPoints(t,o)&&(i=e.indexOf(o))}return i},t.prototype.equalPoints=function(t,e){return t.x==e.x&&t.y==e.y},t.prototype.getEquationByPoss=function(t,e){var i,n,r,o;return t.x==e.x?(i=t.x,o=0,i+"-"+n+"-"+r+"-"+o):t.y==e.y?(n=t.y,o=t.y,r=(e.y-t.y)/(e.x-t.x),i+"-"+n+"-"+r+"-"+o):(r=(e.y-t.y)/(e.x-t.x),o=e.y-r*e.x,i+"-"+n+"-"+r+"-"+o)},t.prototype.addGapCoordinate=function(t,e){var i,n;t.x==e.x?t.y<e.y?(i=t,n=e):(i=e,n=t):t.x<e.x?(i=t,n=e):(i=e,n=t);var r=[i];if(i.x==n.x)if(n.y-i.y==1)r.push(n);else{for(var o=i.y+1;o<n.y;o++)r.push({x:i.x,y:o});r.push(n)}else if(n.x-i.x==1)r.push(n);else{for(var s=i.x+1;s<n.x;s++){var o=n.y-(n.x-s)*(n.y-i.y)/(n.x-i.x);Number.isInteger(o)&&r.push({x:s,y:o})}r.push(n)}return r},t}();__reflect(PathController.prototype,"PathController");var DebugPlatform=function(){function t(){this.lastIsRight=0}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getGameInfo=function(){return{name:document.title}},t.prototype.sendMessage=function(t,e,i,n){void 0===n&&(n=1),3!==i&&(this.lastIsRight=i),console.log("sendToNative",i),console.log(t+"  sendToNative  \ninfo:"+e+"   \nisRight:"+this.lastIsRight+"   \nfinish:"+n),egret.ExternalInterface.call("sendToNative",JSON.stringify({code:t,msg:"success",data:{appId:null,appName:null,userId:null,studentId:null,studentName:null,gameId:null,quesId:null,answer:e,finish:n,isRight:this.lastIsRight,answerTime:0}})),"undefined"!=typeof __paopaoEgretTextbookMessageHandler__&&__paopaoEgretTextbookMessageHandler__({code:t,msg:"success",data:{appId:null,appName:null,userId:null,studentId:null,studentName:null,gameId:null,quesId:null,answer:e,isRight:i,answerTime:0}})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var CMD={CODE:{INIT:10001,ANSWER:10002},AnswerCode:{Invalid:-1,Wrong:0,Right:1,NoAnswer:2,Complete:3},FinishCode:{Finish:0,UnFinish:1}},ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GameResult=function(t){function e(e){var i=t.call(this)||this;return i.showWrongBook=!1,i.skinName=skins.GameResultSkin,i._owner=e,i}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),buttonTapAction(this.replay_btn,this.onReplayBtnClick,this),this.titleGroup.visible=!1,this.enterAction.addEventListener("complete",this.onEnterActionComplete,this)},e.prototype.onReplayBtnClick=function(){soundController.stopEffect("huanhu_mp3"),soundController.stopEffect("fail_mp3"),this._owner&&this._owner.returnGame()},e.prototype.addBackGroundArmuture=function(t){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(i){switch(i.label){case 0:return this.backBoard?[3,2]:(t=this,[4,dbFactory.createArmature("endpage","endpage")]);case 1:t.backBoard=i.sent(),this.backBoard.display.x=this.width/2,this.backBoard.display.y=this.height/2+200,this.backGroup.addChild(this.backBoard.display),i.label=2;case 2:return this.backBoard.display.visible=!0,this.backBoard.play("end",1,.5),this.backBoard.addAnimationCompleteListener().then(function(){e.titleGroup.visible=GameDevice.isShowReturn,window.platform.sendMessage(CMD.CODE.ANSWER,"结束",CMD.AnswerCode.Complete,CMD.FinishCode.Finish)}),[2]}})})},e.prototype.onEnterActionComplete=function(){this.showWrongBook?(this.titleGroup.visible=!1,this.backBoard&&(this.backBoard.display.visible=!1),this.replay_btn.visible=!0):this.replay_btn.visible=!0},e.prototype.showPage=function(t,e){void 0===e&&(e=0),this.visible=t,this.touchEnabled=t,this.titleGroup.visible=!1,this.rightCountLabel.text=e.toString(),soundController.playEffect("huanhu_mp3",0,1),this.titleGroup.visible=GameDevice.isShowReturn,this.enterAction.play(0)},e}(eui.Component);__reflect(GameResult.prototype,"GameResult");var GameSetting=function(t){function e(){var e=t.call(this)||this;return e.btnList=["restart","sound"],e.maskRectHeight=20,e.isOpen=!1,e.soundOpen=!0,e.isPlayAction=!1,e.isPlayMusic=!0,e.skinName=skins.GameSettingSkin,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initBtnList(),this.btnGroup.visible=!0,buttonTapAction(this.btn_set,this.onSettingBtnClick,this),this.btn_set.name="set",this.btnGroup.mask=this.maskRect;for(var e=120,i=0;i<this.btnList.length;i++){var n=this.btnList[i],r=n;"sound"==n&&(r=n+"_on");var o=new eui.Image("btn_"+r+"_png");o.name=n,this.btnGroup.addChild(o),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,buttonTapAction(o,this.onSettingBtnClick,this),o.x=this.btnGroup.width/2,o.y=80+i*e+e/2}this.maskRectHeight=e*this.btnList.length+80,this.bg.height=this.maskRectHeight},e.prototype.initBtnList=function(){for(var t=[],e=0;e<this.btnList.length;e++){var i=this.btnList[e];("restart"!=i&&"refresh"!=i||GameDevice.isShowSettingBtn)&&t.push(i)}this.btnList=t},e.prototype.playOpenAction=function(){var t=this;egret.Tween.removeTweens(this.maskRect),egret.Tween.removeTweens(this.btnGroup),this.isPlayAction=!0;var e=200;this.isOpen?egret.Tween.get(this.maskRect).to({height:0},e).call(function(){t.isOpen=!1,t.isPlayAction=!1}):egret.Tween.get(this.maskRect).to({height:this.maskRectHeight},e).call(function(){t.isOpen=!0,t.isPlayAction=!1})},e.prototype.onSettingBtnClick=function(t){if(!this.isPlayAction){var e=t.currentTarget.name;switch(e){case"set":this.playOpenAction();break;case"refresh":this.onRefreshBtnClick(),this.playOpenAction();break;case"restart":this.onReStartBtnClick(),this.playOpenAction();break;case"sound":this.onMusickBtnClick(t)}soundController.playEffect("click_mp3",0,1)}},e.prototype.onRefreshBtnClick=function(){},e.prototype.onReStartBtnClick=function(){},e.prototype.onMusickBtnClick=function(t){this.isPlayMusic=!this.isPlayMusic;var e=t.currentTarget;this.isPlayMusic?(e.source="btn_sound_on_png",soundController.restoreBGVolume()):(e.source="btn_sound_off_png",soundController.muteBG())},e}(eui.Component);__reflect(GameSetting.prototype,"GameSetting");var Keyset=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.KeySetSkin,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);for(var e=0;10>e;e++)this["key"+e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickKeyFun,this);this.keyRevise.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reviseFun,this),this.keyOk.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this),this.RectBj.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitFun,this)},Object.defineProperty(e.prototype,"num",{get:function(){return this._num},set:function(t){this._num=t,0!==this._num?this.target.text=this._num.toString():this.target.text=""},enumerable:!0,configurable:!0}),e.prototype.clickKeyFun=function(t){var e=t.target.source.split("_")[0],i=parseInt(e.split("key")[1]);this.num=10*this.num+i},e.prototype.init=function(t){this.target=t,this.num=0},e.prototype.reviseFun=function(){this.num=0},e.prototype.submitFun=function(){this.visible=!1},e}(eui.Component);__reflect(Keyset.prototype,"Keyset");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.bar_move=new eui.Image,e.bar_mask=new eui.Image,e.bar_bot=new eui.Image,e.local_x=650,e.local_y=697,e.barLength=100,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.createView,e),e}return __extends(e,t),e.prototype.createView=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=new eui.Rect,t.fillColor=16710124,t.width=this.stage.stageWidth,t.height=this.stage.stageHeight,this.addChild(t),[4,this.addDBArmature()];case 1:return e.sent(),this.initLoading(),[2]}})})},e.prototype.initLoading=function(){var t=new eui.Group;t.x=this.stage.stageWidth/2,t.y=this.local_y+200,this.addChild(t),this.bar_bot=new eui.Image(RES.getRes("loading_progress_bg_png")),this.bar_bot.x=t.width/2,this.bar_bot.y=t.height/2,t.addChild(this.bar_bot),this.bar_bot.anchorOffsetX=this.bar_bot.width/2,this.bar_bot.anchorOffsetY=this.bar_bot.height/2;var e=new eui.Group;t.addChild(e),e.y=-6,this.bar_move=new eui.Image("loading_progress_bar_png"),e.addChild(this.bar_move),this.bar_move.anchorOffsetX=this.bar_move.width/2,this.bar_move.anchorOffsetY=this.bar_move.height/2,this.barLength=this.bar_move.width,this.bar_move.x-=this.barLength,this.bar_mask=new eui.Image("loading_progress_bar_png"),e.addChild(this.bar_mask),this.bar_mask.anchorOffsetX=this.bar_mask.width/2,this.bar_mask.anchorOffsetY=this.bar_mask.height/2,e.mask=this.bar_mask,this.textField=new egret.TextField,this.textField.fontFamily="FZCuYuan-M03S",this.textField.text="0%",this.textField.textAlign="center",this.textField.size=30,this.textField.textColor=16777215,this.textField.width=this.stage.stageWidth,this.textField.height=30,this.textField.anchorOffsetX=this.textField.width/2,this.textField.anchorOffsetY=this.textField.height/2,this.textField.y=-5,t.addChild(this.textField)},e.prototype.onProgress=function(t,e){this.textField.text=""+Math.floor(t/e*100).toString()+"%",this.bar_move.x=-this.barLength+this.barLength*(t/e)},e.prototype.addDBArmature=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return[4,dbFactory.createArmature("loadingxiaoxiang","xiaoxiangrunning").then(function(e){t.addChild(e.display),e.display.x=t.stage.stageWidth/2,e.display.y=t.local_y+150;var i=new eui.Rect;i.fillColor=16777215,i.width=804,i.height=665,i.anchorOffsetX=i.width>>1,i.anchorOffsetY=i.height>>1,i.x=t.stage.stageWidth/2,i.y=t.local_y-50,e.display.mask=i,t.addChild(i),e.play("running",0)})];case 1:return e.sent(),[2]}})})},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var GameDevice=function(){function t(){}return Object.defineProperty(t,"isShowReturn",{get:function(){return void 0!=window.__math2_res_config__?!0:window.isAI?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isShowRefresh",{get:function(){return void 0!=window.__math2_res_config__?!0:window.isAI?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isShowSettingBtn",{get:function(){return void 0!=window.__math2_res_config__?!1:window.isAI?!1:!0},enumerable:!0,configurable:!0}),t}();__reflect(GameDevice.prototype,"GameDevice");var SoundBtn=function(t){function e(){var e=t.call(this)||this;return e.isPlay=!1,e.soundSource="",e.playIndex=3,e.skinName=skins.SoundBtnSkin,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),buttonTapAction(this.display,this.onSoundBtnClick,this)},e.prototype.onSoundBtnClick=function(){this.soundSource&&""!=this.soundSource&&(this.isPlay?(this.isPlay=!1,this.tryPlaySoundAction(!1)):this.playSound())},e.prototype.soundDisplayAction=function(){this.playIndex++,this.playIndex>3&&(this.playIndex=1),this.display.source="sound_play_"+this.playIndex+"_png"},e.prototype.tryPlaySoundAction=function(t){t?timeController.addAlarm(300,this.soundDisplayAction,this,!0):(timeController.removeAlarm(this.soundDisplayAction,this),this.playIndex=3,this.display.source="sound_play_"+this.playIndex+"_png")},e.prototype.playSound=function(){var t=this;this.soundSource&&""!=this.soundSource&&(soundController.playEffect(this.soundSource,0,1).playEnd=function(){t.isPlay=!1,t.tryPlaySoundAction(!1)},this.isPlay=!0,this.tryPlaySoundAction(!0))},e.prototype.setSoundSource=function(t){this.soundSource=t},e}(eui.Component);__reflect(SoundBtn.prototype,"SoundBtn");var StarItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.StarSkin,e}return __extends(e,t),e.prototype.showStar=function(t){void 0===t&&(t=!0),this.star.scaleX=0,this.star.scaleY=0,egret.Tween.removeTweens(this.star),this.star.visible=!0,t&&soundController.playEffect("star_mp3",0,1),egret.Tween.get(this.star).to({scaleX:1.5,scaleY:1.5},300).to({scaleX:1,scaleY:1},200)},e.prototype.changeSkin=function(t,e){this.bg.source=t,this.star.source=e},e.prototype.clear=function(){this.star.visible=!1},e}(eui.Component);__reflect(StarItem.prototype,"StarItem");var StarProgress=function(t){function e(){var e=t.call(this)||this;return e.maxStar=5,e.currentStar=0,e.baseY=532,e.MaxHeight=518,e.skinName=skins.StarProgressSkin,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.progressGroup.mask=this.maskImage,this.progressImg.visible=!0,this.baseY=this.maskImage.y+this.maskImage.height,this.MaxHeight=this.maskImage.height,this.clear()},e.prototype.updateStarProgress=function(){var t=this.currentStar/this.maxStar;this.progressImg.y=this.baseY-t*this.MaxHeight},e.prototype.setProgress=function(t){if(t=Math.min(t,this.maxStar),t=Math.max(0,t),t!=this.currentStar){for(var e=this.currentStar;t>e;e++)this["star"+e].showStar();this.currentStar=t,this.updateStarProgress()}},e.prototype.clear=function(){this.currentStar=0;for(var t=0;t<this.maxStar;t++)this["star"+t].clear();this.updateStarProgress()},e}(eui.Component);__reflect(StarProgress.prototype,"StarProgress");var XDFLogoComponent=function(t){function e(){var e=t.call(this)||this;return e.percentHeight=100,e.percentWidth=100,e.addLogoImage(),e}return __extends(e,t),e.prototype.addLogoImage=function(){var t=new eui.Image;t.source="_xdf_logo__png",t.anchorOffsetX=t.width,t.anchorOffsetY=t.height,t.bottom=0,t.right=0,this.addChild(t)},e.prototype.addToParent=function(t){t.percentHeight=100,t.percentWidth=100,t.touchChildren=!1,t.touchEnabled=!1,t.touchThrough=!0,t.addChild(this)},e}(eui.Component);__reflect(XDFLogoComponent.prototype,"XDFLogoComponent");var BezierFactory=function(){function t(){this._progress=0,this._bazier_x=0,this._bazier_y=0,this._star_point={x:0,y:0},this._achor_point={x:0,y:0},this._end_point={x:0,y:0}}return Object.defineProperty(t.prototype,"progress",{get:function(){return this._progress},set:function(t){0>t&&(t=0),t>1&&(t=1),this._progress=t,this._bazier_x=(1-t)*(1-t)*this._star_point.x+2*t*(1-t)*this._achor_point.x+t*t*this._end_point.x,this._bazier_y=(1-t)*(1-t)*this._star_point.y+2*t*(1-t)*this._achor_point.y+t*t*this._end_point.y,this.onValueChange(this._bazier_x,this._bazier_y)},enumerable:!0,configurable:!0}),t.prototype.onValueChange=function(t,e){},t.prototype.setBezierPoint=function(t,e,i){this._star_point=t,this._achor_point=e,this._end_point=i
},t}();__reflect(BezierFactory.prototype,"BezierFactory");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameDefins=function(){function t(){this.ballBornX=1628,this.ballFirstEnterY=700,this.ballEndPoint={x:297,y:980},this.ballSize={width:155,height:165},this.stepTime=500,this.itemFlySpeed=3.5,this.ballSpeed=.15,this.ballSpeed4=1,this.resultShowTime=4e3,this.MaxCount=7,this.mapWidth=10,this.mapHeight=9,this.roundTime=200}return t}();__reflect(GameDefins.prototype,"GameDefins");var gameDefines=new GameDefins,Global=function(){function t(){}return t.gameEvent=new EventHandler,t}();__reflect(Global.prototype,"Global");var Helper=function(){function t(){}return t.prototype.copyArr=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e},t.prototype.hasCapital=function(t){var e=t.match(/^.*[A-Z]+.*$/);return null==e?!1:!0},t.prototype.changeDisplayZIndex=function(t,e){var i=[].concat(e);i.sort(function(t,e){return t.y>e.y?1:-1});for(var n=0;n<i.length;n++)t.setChildIndex(i[n],n);i=[]},t}();__reflect(Helper.prototype,"Helper");var helper=new Helper,GameData=function(){function t(){this.itemConfig=[[[1],[1],[1],[1]],[[0,1],[0,1],[1,1]],[[1,0],[1,0],[1,1]],[[1,1],[1,1]],[[1,1,0],[0,1,1]],[[0,1,0],[1,1,1]],[[0,1,1],[1,1,0]]]}return t.prototype.getItems=function(){var t=[].concat(this.itemConfig);return t},t}();__reflect(GameData.prototype,"GameData");var gameData=new GameData,DBFactory=function(){function t(){this.baseFactory=new dragonBones.EgretFactory,this.armatureList=[],this.nameHash={}}return t.prototype.pushDBtoFactory=function(t){var e=this,i=RES.getResAsync(t+"_ske_json"),n=RES.getResAsync(t+"_tex_json"),r=RES.getResAsync(t+"_tex_png");return Promise.all([i,n,r]).then(function(t){var i=t[0],n=t[1],r=t[2];e.baseFactory.parseDragonBonesData(i),e.baseFactory.parseTextureAtlasData(n,r)})["catch"](function(t){console.error("解析龙骨失败")})},t.prototype.createArmature=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n,r;return __generator(this,function(o){switch(o.label){case 0:return this.nameHash[t]?[3,2]:[4,this.pushDBtoFactory(t)];case 1:o.sent(),this.nameHash[t]=1,o.label=2;case 2:return i=e,i||(i=t),[4,this.baseFactory.buildArmature(i)];case 3:return n=o.sent(),r=this.getArmatureInPool(),r.initData(n,this.baseFactory),[2,r]}})})},t.prototype.releaseArmature=function(t){t&&(t.dispose(this.baseFactory),this.armatureList.push(t))},t.prototype.getArmatureInPool=function(){return this.armatureList.length>0?this.armatureList.pop():new Armature},t}();__reflect(DBFactory.prototype,"DBFactory");var Armature=function(){function t(){}return t.prototype.play=function(t,e,i){void 0===i&&(i=1),this._armature.animation.play(t,e).timeScale=i},t.prototype.stop=function(t){this._armature.animation.stop(t)},t.prototype.gotoAndPlayByFrame=function(t,e,i){return this._armature.animation.gotoAndPlayByFrame(t,e,i)},t.prototype.goToAndStopFrame=function(t,e){void 0===e&&(e=0),this._armature.animation.gotoAndStopByFrame(t,e)},Object.defineProperty(t.prototype,"display",{get:function(){return this._armature.display},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventDispatcher",{get:function(){return this._armature.eventDispatcher},enumerable:!0,configurable:!0}),t.prototype.initData=function(t,e){this._armature=t,e.clock.add(this._armature)},Object.defineProperty(t.prototype,"armatureName",{get:function(){return this._armature.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),t.prototype.addAnimationCompleteListener=function(){var e=this;return new Promise(function(i,n){var r=function(){delete t.AnimationCompleteCallbackHash[e._armature.hashCode],e._armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.COMPLETE,r,e),i(e)};t.AnimationCompleteCallbackHash[e._armature.hashCode]=r,e._armature.eventDispatcher.hasDBEventListener(dragonBones.EventObject.COMPLETE)||e._armature.eventDispatcher.addDBEventListener(dragonBones.EventObject.COMPLETE,r,e)})},t.prototype.clearAnimationCompleteListener=function(){var e=t.AnimationCompleteCallbackHash[this._armature.hashCode];this._armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.COMPLETE,e,this),delete t.AnimationCompleteCallbackHash[this._armature.hashCode]},t.prototype.addAnimationFRAMEListener=function(e){var i=this,n=function(){delete t.AnimationFRAMECallbackHash[i._armature.hashCode],i._armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.FRAME_EVENT,n,i),e()};t.AnimationCompleteCallbackHash[this._armature.hashCode]=n,this._armature.eventDispatcher.hasDBEventListener(dragonBones.EventObject.FRAME_EVENT)||this._armature.eventDispatcher.addDBEventListener(dragonBones.EventObject.FRAME_EVENT,n,this)},t.prototype.clearAnimationFRAMEListener=function(){var e=t.AnimationFRAMECallbackHash[this._armature.hashCode];this._armature.eventDispatcher.removeDBEventListener(dragonBones.EventObject.COMPLETE,e,this),delete t.AnimationFRAMECallbackHash[this._armature.hashCode]},t.prototype.getSlot=function(t){return this._armature.getSlot(t)},t.prototype.dispose=function(t){t.clock.remove(this._armature),this._armature.dispose()},Object.defineProperty(t.prototype,"cacheframerate",{set:function(t){this._armature.cacheFrameRate=t},enumerable:!0,configurable:!0}),t.AnimationCompleteCallbackHash={},t.AnimationFRAMECallbackHash={},t}();__reflect(Armature.prototype,"Armature");var dbFactory=new DBFactory,SoundController=function(){function t(){this._volume=.5,this._effectHash={},this.isMuteEffect=!1,this._bgMusicHash={},this.isMuteBG=!1}return Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){t=Math.min(t,1),t=Math.max(t,0),this._volume=t;for(var e in this._effectHash)this._effectHash[e].volume=t},enumerable:!0,configurable:!0}),t.prototype.playEffect=function(t,e,i){var n=this;if(this._effectHash[t]&&2==this._effectHash[t].loaded)this._effectHash[t].play(e,i),this.isMuteEffect&&this._effectHash[t].mute();else{if(this._effectHash[t]&&1==this._effectHash[t].loaded)return;this._effectHash[t]=new Sound(t),this._effectHash[t].load().then(function(){n._effectHash[t].play(e,i),n.isMuteEffect&&n._effectHash[t].mute()})}return this._effectHash[t]},t.prototype.stopEffect=function(t){this._effectHash[t]&&this._effectHash[t].stop()},t.prototype.setEffectVolumeByUrl=function(t,e){e=Math.min(e,1),e=Math.max(e,0),this._effectHash[t]&&(this._effectHash[t].volume=e)},t.prototype.getEffectVolumeByUrl=function(t){return this._effectHash[t]?this._effectHash[t].volume:null},t.prototype.muteEffect=function(){for(var t in this._effectHash)this._effectHash[t].mute();egret.localStorage.setItem("muteEffect","0"),this.isMuteEffect=!0},t.prototype.restoreEffectVolume=function(){for(var t in this._effectHash)this._effectHash[t].restoreVolume();egret.localStorage.setItem("muteEffect","1"),this.isMuteEffect=!1},t.prototype.playBG=function(t,e,i){var n=this;if(this._bgMusicHash[t]&&2==this._bgMusicHash[t].loaded)this._bgMusicHash[t].play(e,i),this.isMuteBG&&this._bgMusicHash[t].mute();else{if(this._bgMusicHash[t]&&1==this._bgMusicHash[t].loaded)return;this._bgMusicHash[t]=new Sound(t),this._bgMusicHash[t].load().then(function(){n._bgMusicHash[t].play(e,i),n.isMuteBG&&n._bgMusicHash[t].mute()})}return this._bgMusicHash[t]},t.prototype.stopBG=function(t){this._bgMusicHash[t]&&this._bgMusicHash[t].stop()},t.prototype.setBGVolumeByUrl=function(t,e){e=Math.min(e,1),e=Math.max(e,0),this._bgMusicHash[t]&&(this._bgMusicHash[t].volume=e)},t.prototype.getBGVolumeByUrl=function(t){return this._bgMusicHash[t]?this._bgMusicHash[t].volume:null},t.prototype.muteBG=function(){for(var t in this._bgMusicHash)this._bgMusicHash[t].mute();this.isMuteBG=!0},t.prototype.restoreBGVolume=function(){for(var t in this._bgMusicHash)this._bgMusicHash[t].restoreVolume();this.isMuteBG=!1},t}();__reflect(SoundController.prototype,"SoundController");var Sound=function(){function t(t){this.url=t,this._isPlay=!1,this._load=0,this._volume=.5,this._mute=!1}return t.prototype.load=function(){var t=this;return new Promise(function(e,i){if(t._load=1,t._currentSound=new egret.Sound,RES.getRes(t.url))t._currentSound=RES.getRes(t.url),t._load=2,e(t._currentSound);else{console.log("音频通过原生load");var n=function(i){t._currentSound.removeEventListener(egret.Event.COMPLETE,n,t),t._load=2,e(t._currentSound)};t._currentSound.addEventListener(egret.Event.COMPLETE,n,t),t._currentSound.load(("undefined"==typeof RES_ROOT?"resource/":RES_ROOT)+t.url)}})},Object.defineProperty(t.prototype,"loaded",{get:function(){return this._load},enumerable:!0,configurable:!0}),t.prototype.play=function(t,e){this._isPlay||(void 0==t&&(t=0),void 0==e&&(e=0),this._currentChannel=this._currentSound.play(t,e),this._mute?this._currentChannel.volume=0:this._currentChannel.volume=this._volume,this._isPlay=!0,this._currentChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.playOver,this))},t.prototype.playOver=function(){this._currentChannel.removeEventListener(egret.Event.SOUND_COMPLETE,this.playOver,this),this.playEnd(),this._isPlay=!1},t.prototype.playEnd=function(){},t.prototype.stop=function(){this._isPlay&&(this._currentChannel.stop(),this._isPlay=!1)},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this._isPlay&&(this._currentChannel.volume=t)},enumerable:!0,configurable:!0}),t.prototype.mute=function(){this._mute=!0,this._currentChannel&&this._isPlay&&(this._currentChannel.volume=0)},t.prototype.restoreVolume=function(){this._mute=!1,this._currentChannel&&this._isPlay&&(this._currentChannel.volume=this._volume)},t}();__reflect(Sound.prototype,"Sound");var soundController=new SoundController,RES_ROOT,GameTimeController=function(){function t(){this.passTime=0,this.lastTime=0,this.eventList=[]}return t.prototype.startTicker=function(){this.lastTime=(new Date).getTime(),egret.startTick(this.update,this)},t.prototype.addAlarm=function(t,e,i,n){void 0===n&&(n=!1);var r=this.getSystemTime();this.eventList.push({startTime:r,delay:t,callback:e,thisObject:i,isLoop:n})},t.prototype.removeAlarm=function(t,e){for(var i=0;i<this.eventList.length;i++){var n=this.eventList[i];n.callback==t&&n.thisObject==e&&this.eventList.splice(i,1)}},t.prototype.setDelayTime=function(t,e,i){for(var n=0;n<this.eventList.length;n++){var r=this.eventList[n];r.callback==e&&r.thisObject==i&&(this.eventList[n].delay=t)}},t.prototype.check=function(t){for(var e=this.eventList.slice(),i=0;i<e.length;i++){var n=e[i],r=n.startTime,o=n.delay,s=n.callback,a=n.thisObject,h=n.isLoop;r+o>t||(s.call(a,t),h?e[i].startTime=t:this.removeAlarm(s,a))}return!0},t.prototype.getSystemTime=function(){return(new Date).getTime()},t.prototype.dispose=function(){this.eventList=[],egret.stopTick(this.update,this)},t.prototype.update=function(){var t=this.getSystemTime();if(this.check(t),t-this.lastTime>=500){var e=t-this.lastTime;this.passTime=this.passTime+e,this.lastTime=(new Date).getTime()}return!0},t}();__reflect(GameTimeController.prototype,"GameTimeController");var timeController=new GameTimeController;